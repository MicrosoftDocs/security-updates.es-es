---
TOCTitle: 'MS07-028'
Title: 'Boletín de seguridad de Microsoft MS07-028 - Crítica'
ms:assetid: 'ms07-028'
ms:contentKeyID: 61225308
ms:mtpsurl: 'https://technet.microsoft.com/es-ES/library/ms07-028(v=Security.10)'
---

Security Bulletin

Boletín de seguridad de Microsoft MS07-028 - Crítica
====================================================

Una vulnerabilidad en CAPICOM podría permitir la ejecución remota de código (931906)
------------------------------------------------------------------------------------

Publicado: martes, 8 de mayo de 2007

**Versión:** 1.0

#### Resumen

**Quién debería leer este documento:** Los clientes que usan CAPICOM o BizTalk 2004

**Consecuencia de la vulnerabilidad:** Ejecución remota de código

**Gravedad máxima:** Crítica

**Recomendación:** Los clientes deberían aplicar esta actualización inmediatamente.

**Actualizaciones de seguridad reemplazadas:** Ninguna

**Advertencias:** Ninguna

**Ubicaciones de descarga de la actualización de seguridad y productos probados:**

**Software afectado:**

-   CAPICOM: [Descargar la actualización](http://www.microsoft.com/downloads/details.aspx?familyid=ca930018-4a66-4da6-a6c5-206df13af316)
-   Platform SDK Redistributable: CAPICOM: [Descargar la actualización](http://www.microsoft.com/downloads/details.aspx?familyid=ca930018-4a66-4da6-a6c5-206df13af316)
-   BizTalk Server 2004 Service Pack 1: [Descargar la actualización](http://www.microsoft.com/downloads/details.aspx?familyid=ca930018-4a66-4da6-a6c5-206df13af316)
-   BizTalk Server 2004 Service Pack 2: [Descargar la actualización](http://www.microsoft.com/downloads/details.aspx?familyid=ca930018-4a66-4da6-a6c5-206df13af316)

**Software no afectado:**

-   BizTalk Server 2000
-   BizTalk Server 2002
-   BizTalk Server 2006

Los programas de esta lista han sido probados para determinar si las versiones están afectadas. Otras versiones han llegado al final de su ciclo de vida o no están afectadas. Para determinar el ciclo de vida del soporte técnico de su producto y versión, visite el sitio web [Ciclo de vida del soporte técnico de Microsoft](http://go.microsoft.com/fwlink/?linkid=21742).

### Información general

Resumen ejecutivo
-----------------

<span></span>
**Resumen ejecutivo:**

Esta actualización resuelve una vulnerabilidad descubierta recientemente, de la que se ha informado de forma privada. La vulnerabilidad se documenta en su propia subsección de la sección "Detalles de la vulnerabilidad" de este boletín.

Es recomendable que los clientes apliquen la actualización inmediatamente.

**Gravedad e identificadores de vulnerabilidad:**

| Identificadores de vulnerabilidad                                                                                        | Consecuencia de la vulnerabilidad | CAPICOM | Microsoft BizTalk Server 2004 |
|--------------------------------------------------------------------------------------------------------------------------|-----------------------------------|---------|-------------------------------|
| Vulnerabilidad en CAPICOM.Certificates: [CVE-2007-0940](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2007-0940) | Ejecución remota de código        | Crítica | Crítica                       |

Esta [clasificación](http://technet.microsoft.com/security/bulletin/rating) está basada en los tipos de sistemas afectados por la vulnerabilidad, sus patrones típicos de implementación y el efecto que podría tener un ataque en el que se aprovechara la vulnerabilidad.

Preguntas más frecuentes (P+F) relacionadas con esta actualización de seguridad
-------------------------------------------------------------------------------

<span></span>
**¿Qué actualizaciones reemplaza esta versión?**
Esta actualización de seguridad no reemplaza a ninguna actualización de seguridad anterior.

**¿Se puede usar Microsoft Baseline Security Analyzer (MBSA) para determinar si esta actualización es necesaria?**
La tabla siguiente proporciona el resumen de detección MBSA correspondiente a esta actualización de seguridad.

| Producto            | MBSA 1.2.1 | EST | MBSA 2.0.1 |
|---------------------|------------|-----|------------|
| CAPICOM             | No         | Sí  | Sí         |
| BizTalk Server 2004 | No         | Sí  | Sí         |

Para obtener más información acerca de MBSA, visite el [sitio web de MBSA](http://www.microsoft.com/technet/security/tools/mbsahome.mspx). Para obtener más información acerca del software que Microsoft Update y MBSA 2.0 no detectan actualmente, consulte el [artículo 895660 de Microsoft Knowledge Base](http://support.microsoft.com/kb/895660).

Para obtener información más detallada, consulte el [artículo 910723 de Microsoft Knowledge Base](http://support.microsoft.com/kb/910723): Lista de resumen de artículos de orientación mensuales sobre detección e implementación.

**¿Qué es la herramientaEnterprise** **Update Scan Tool (EST)?**
Como parte de un compromiso continuo para proporcionar herramientas de detección para actualizaciones de seguridad de tipo boletín, Microsoft ofrece una herramienta de detección independiente siempre que Microsoft Baseline Security Analyzer 1.2.1 y la herramienta Office Detection Tool (ODT) no puedan detectar si la actualización es necesaria para un ciclo de publicación de MSRC. Esta herramienta independiente se denomina Enterprise Update Scan Tool (EST) y está diseñada para los administradores de empresa. Cuando se crea una versión de la herramienta Enterprise Update Scan Tool para un boletín específico, los clientes pueden ejecutar la herramienta desde una interfaz de línea de comandos y ver los resultados del archivo de salida XML. Para ayudar a los clientes a utilizar mejor la herramienta, se proporcionará documentación detallada con la misma. También existe una versión de la herramienta que ofrece una experiencia integrada para los administradores de SMS.

**¿Se puede utilizar una versión de la herramienta** **Enterprise** **Update Scan Tool (EST) para determinar si esta actualización es necesaria?**
Sí. Microsoft ha creado una versión de la herramienta EST que puede determinar si se necesita aplicar esta actualización. Para obtener vínculos de descarga e información adicional acerca de la versión de EST que se publica este mes, vea el [artículo 894193 de Microsoft Knowledge Base](http://support.microsoft.com/kb/894193). Es aconsejable que los clientes de SMS consulten la pregunta "¿Se puede utilizar Systems Management Server (SMS) para determinar si esta actualización es necesaria?" de la sección Preguntas más frecuentes para obtener más información acerca de SMS y EST.

**¿Se puede utilizar Systems Management Server (SMS) para determinar si esta actualización es necesaria?**
La tabla siguiente proporciona el resumen de detección SMS correspondiente a esta actualización de seguridad.

| Producto            | SMS 2.0                     | SMS 2003 |
|---------------------|-----------------------------|----------|
| CAPICOM             | Sí (con la herramienta EST) | Sí       |
| BizTalk Server 2004 | Sí (con la herramienta EST) | Sí       |

SMS 2.0 y SMS 2003 Software Update Services (SUS) Feature Pack pueden usar MBSA 1.2.1 para la detección y, por lo tanto, tener la misma limitación que la indicada anteriormente en este boletín con relación a los programas que no detecta MBSA 1.2.1.

En cuanto a SMS 2.0, SMS puede usar el SMS SUS Feature Pack, que incluye la herramienta Security Update Inventory Tool (SUIT), para detectar actualizaciones de seguridad. SMS UIT usa el motor de MBSA 1.2.1 para la detección. Para obtener más información acerca de SUIT, visite el siguiente [sitio web de Microsoft](http://support.microsoft.com/kb/894154/). Para obtener más información acerca de las limitaciones de SUIT, consulte el [artículo 306460 de Microsoft Knowledge Base.](http://support.microsoft.com/kb/306460/) SMS SUS Feature Pack incluye también la herramienta Microsoft Office Inventory Tool, que permite detectar las actualizaciones requeridas para las aplicaciones de Microsoft Office.

En cuanto a SMS 2003, SMS puede utilizar la herramienta SMS 2003 Inventory Tool for Microsoft Updates (ITMU) para detectar actualizaciones de seguridad proporcionadas por [Microsoft Update](http://update.microsoft.com/microsoftupdate) y compatibles con [Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Para obtener más información acerca de SMS 2003 ITMU, visite el siguiente [sitio web de Microsoft](http://go.microsoft.com/fwlink/?linkid=72181). Además, SMS 2003 puede usar Microsoft Office Inventory Tool con el fin de detectar las actualizaciones requeridas para las aplicaciones de Microsoft Office.

Para obtener más información acerca de SMS, visite el [sitio web de SMS](http://www.microsoft.com/spain/smserver/default.mspx).

Para obtener información más detallada, consulte el [artículo 910723 de Microsoft Knowledge Base](http://support.microsoft.com/kb/910723): Lista de resumen de artículos de orientación mensuales sobre detección e implementación.

**¿Se puede usar SMS para determinar si hay otros programas instalados que tengan que actualizarse?**
Sí. SMS puede ayudar a detectar si hay otros programas instalados que puedan tener instalada una versión del componente vulnerable. SMS puede determinar la presencia del archivo CAPICOM.dll. Actualice todas las versiones de CAPICOM.dll que sean anteriores a la 2.1.0.2.

Detalles de la vulnerabilidad
-----------------------------

<span></span>
#### Vulnerabilidad en CAPICOM.Certificates (CVE-2007-0940):

Existe una vulnerabilidad de ejecución remota de código en CAPICOM que podría permitir a un atacante que consiga aprovechar esta vulnerabilidad tomar el control completo del sistema afectado.

#### Factores atenuantes de la vulnerabilidad en CAPICOM.Certificates (CVE-2007-0940):

-   En el caso de un ataque basado en Web, el atacante tendría que alojar un sitio web que contuviera una página web para aprovechar esta vulnerabilidad. El atacante no podría obligar a los usuarios a visitar un sitio web especialmente diseñado. Por tanto, tendría que atraerlos al sitio web, normalmente incitándoles a hacer clic en un vínculo que lleve al mismo. Al hacer clic en el vínculo, se les pedirá que realicen varias acciones. El ataque solamente podría tener lugar después de realizar estas acciones.
-   Un intruso que aprovechara esta vulnerabilidad podría conseguir el mismo nivel de derechos de usuario que el usuario local. Por tanto, los usuarios cuyas cuentas estén configuradas con pocos derechos de usuario en el sistema correrían un riesgo menor que aquellos que cuenten con derechos de usuario administrativos.
-   De forma predeterminada, todas las versiones admitidas de Microsoft Outlook y Microsoft Outlook Express abren los mensajes de correo electrónico HTML en la zona Sitios restringidos. La zona Sitios restringidos ayuda a reducir el número de ataques que podrían aprovechar esta vulnerabilidad al impedir que se usen controles ActiveX y secuencias de comandos ActiveX cuando se lee correo electrónico HTML. Sin embargo, si un usuario hace clic en un vínculo de un mensaje de correo electrónico, aún podría ser vulnerable a este problema ante la posibilidad de un ataque basado en web.
-   De forma predeterminada, Internet Explorer en Windows Server 2003 se ejecuta en un modo restringido conocido como [Configuración de seguridad mejorada](http://msdn.microsoft.com/library/default.asp?url=/workshop/security/szone/overview/esc_changes.asp). Este modo establece el nivel de seguridad para la zona Internet en Alto. Esto constituye un factor atenuante para sitios web que no se han agregado a la zona de sitios de confianza de Internet Explorer. Vea la subsección P+F correspondiente a esta sección de vulnerabilidad para obtener más información acerca de la configuración de seguridad mejorada de Internet Explorer.
-   De forma predeterminada, este control ActiveX no está incluido en la lista predeterminada de controles ActiveX permitidos en Internet Explorer 7. Sólo los clientes que han aprobado explícitamente este control mediante la característica ActiveX opcional están expuestos a los intentos de aprovechar esta vulnerabilidad. Sin embargo, si un cliente ha usado este control ActiveX en una versión anterior de Internet Explorer, entonces este control ActiveX está habilitado para funcionar en Internet Explorer 7, incluso si el cliente no lo ha aprobado explícitamente mediante la característica ActiveX opcional.

#### Soluciones provisionales para la vulnerabilidad en CAPICOM.Certificates (CVE-2007-0940):

Microsoft ha probado las siguientes soluciones provisionales. Aunque estas soluciones provisionales no corrigen la vulnerabilidad subyacente, ayudan a bloquear los tipos de ataque conocidos. Cuando una solución provisional reduce la funcionalidad, se identifica en la siguiente sección.

-   **Deshabilite los intentos para ejecutar el control CAPICOM en Internet Explorer**

    Puede deshabilitar los intentos de ejecutar este control ActiveX configurando el bit de interrupción del control en el Registro.

    **Advertencia** Si utiliza el Editor del Registro incorrectamente, puede provocar problemas graves que conlleven la reinstalación del sistema operativo. Microsoft no le garantiza que pueda resolver los problemas provocados por el uso incorrecto del Editor del Registro. El uso del Editor del Registro es responsabilidad suya.

    Si desea ver el procedimiento detallado para impedir que un control se ejecute en Internet Explorer, consulte el [artículo 240797 de Microsoft Knowledge Base](http://support.microsoft.com/kb/240797). Siga estos pasos para crear un valor de indicadores de compatibilidad en el Registro para evitar que se ejecute un objeto COM en Internet Explorer.

    Con el fin de configurar el bit de interrupción para los CLSID con el valor de:

    -   {17E3A1C3-EA8A-4970-AF29-7F54610B1D4C}
    -   {FBAB033B-CDD0-4C5E-81AB-AEA575CD1338}

    Pegue el texto siguiente en un editor de texto como Bloc de notas. A continuación, guarde el archivo con la extensión de nombre de archivo .reg.

    Editor del Registro de Windows versión 5.00
    \[HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{17E3A1C3-EA8A-4970-AF29-7F54610B1D4C}\]

    "Compatibility Flags"=dword:00000400

    \[HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{FBAB033B-CDD0-4C5E-81AB-AEA575CD1338}\]

    "Compatibility Flags"=dword:00000400

    Puede aplicar este archivo .reg a sistemas individuales si hace doble clic en él. También puede aplicarlo entre dominios mediante Directiva de grupo. Para obtener más información acerca de directivas de grupo, consulte los siguientes sitios web de Microsoft:

    [Colección de directivas de grupo](http://www.microsoft.com/technet/prodtechnol/windowsserver2003/library/techref/6d7cb788-b31d-4d17-9f1e-b5ddaa6deecd.mspx)

    [¿Qué es el editor de objetos de directiva de grupo?](http://www.microsoft.com/technet/prodtechnol/windowsserver2003/library/techref/47ba1311-6cca-414f-98c9-2d7f99fca8a3.mspx)

    [Configuración y herramientas básicas de directiva de grupo](http://www.microsoft.com/technet/prodtechnol/windowsserver2003/library/techref/e926577a-5619-4912-b5d9-e73d4bdc9491.mspx)

    **Nota:** Debe reiniciar Internet Explorer para que los cambios surtan efecto.

    **Consecuencias de la solución provisional**: Puede que el control de CAPICOM ya no se muestre o no funcione correctamente.

-   **Configurar Internet Explorer de forma que se pregunte al usuario antes de ejecutar o deshabilitar controles ActiveX en las zonas de seguridad de Internet e Intranet local**

    Puede colaborar en la protección contra esta vulnerabilidad modificando la configuración Internet Explorer de modo que se pregunte antes de ejecutar controles de ActiveX. Para ello, siga estos pasos:

    1.  En Internet Explorer, haga clic en **Opciones de Internet** en el menú **Herramientas**.
    2.  Haga clic en la ficha **Seguridad**.
    3.  Haga clic en **Internet** y, a continuación, haga clic en **Nivel personalizado**.
    4.  En **Configuración**, en la sección **Controles y complementos de ActiveX**, en **Ejecutar controles y complementos de ActiveX**, haga clic en **Pedir datos** o **Deshabilitar**, y, a continuación, haga clic en **Aceptar**.
    5.  Haga clic en **Intranet local** y, a continuación, haga clic en **Nivel personalizado**.
    6.  En **Configuración**, en la sección **Controles y complementos de ActiveX**, en **Ejecutar controles y complementos de ActiveX**, haga clic en **Pedir datos** o **Deshabilitar**, y, a continuación, haga clic en **Aceptar**.
    7.  Haga clic en **Aceptar** dos veces para volver a Internet Explorer.

    **Consecuencias de la solución provisional:** Preguntar antes de ejecutar los controles ActiveX conlleva efectos secundarios. Muchos sitios web de Internet o una intranet utilizan controles ActiveX para aportar funciones adicionales. Por ejemplo, un sitio de comercio electrónico en línea o el sitio de un banco pueden utilizar controles ActiveX para ofrecer menús, formularios de pedido o incluso movimientos de cuentas. Preguntar antes de ejecutar los controles ActiveX (Pedir datos) es una configuración global que afecta a todos los sitios de Internet e Intranet. Cuando habilite esta solución, se le preguntará para que dé su conformidad con bastante frecuencia. En cada pregunta, si confía en el sitio que está visitando, haga clic en **Sí** para ejecutar los controles ActiveX. Si no desea que se le pregunte para todos estos sitios, siga los pasos de la sección "Agregue sitios en los que confía a la zona de sitios de confianza de Internet Explorer".

    **Agregar sitios en los que confía a la zona de sitios de confianza de Internet Explorer**

    Después de configurar Internet Explorer para exigir que le pregunte antes de ejecutar controles y secuencias de comandos ActiveX en las zonas Internet e Intranet local, puede agregar sitios en los que confíe a la zona Sitios de confianza de Internet Explorer. De esta forma, podrá seguir utilizando como siempre los sitios web de confianza al tiempo que colabora para protegerse de este ataque en los sitios en los que no confía. Se recomienda agregar solamente sitios en los que confíe a la zona Sitios de confianza.

    Para ello, siga estos pasos:

    1.  En Internet Explorer, haga clic en **Herramientas**, **Opciones de Internet** y, a continuación, en la ficha **Seguridad**.
    2.  En el cuadro **Seleccione una zona de contenido web para especificar la configuración de seguridad de la misma**, haga clic en **Sitios de confianza** y, a continuación, en **Sitios**.
    3.  Si desea agregar sitios que no requieren un canal cifrado, haga clic para desactivar la casilla de verificación **Requerir comprobación del servidor (https:) para todos los sitios de esta zona**.
    4.  En el cuadro **Agregar este sitio web a la zona**, escriba la dirección URL de un sitio en el que confíe y haga clic en **Agregar**.
    5.  Repita estos pasos para cada sitio que desee agregar a la zona.
    6.  Haga clic en **Aceptar** dos veces para confirmar los cambios y regresar a Internet Explorer.

    **Nota** Agregue todos los sitios de confianza para los que tenga la certeza de que no realizarán ninguna acción perjudicial en su equipo. En concreto, hay dos sitios que es aconsejable agregar: "\*.windowsupdate.microsoft.com" y "\*.update.microsoft.com" (sin las comillas). Se trata de los sitios que alojarán la actualización y requieren de un control ActiveX para instalarla.

-   **Configurar las zonas de seguridad de Internet e Intranet local en “Alta”, de forma que se pregunte antes de ejecutar controles ActiveX y secuencias de comandos ActiveX en estas zonas**

    Puede colaborar en la protección contra esta vulnerabilidad modificando la configuración de la zona de seguridad de Internet para que solicite datos antes de ejecutar controles de ActiveX. Para ello, establezca la seguridad del explorador en **Alta**.

    Para aumentar el nivel de seguridad en Microsoft Internet Explorer, siga estos pasos:

    1.  En el menú **Herramientas** de Internet Explorer, haga clic en **Opciones de Internet**.
    2.  En el cuadro de diálogo **Opciones de Internet**, haga clic en la ficha **Seguridad** y, a continuación, en el icono **Internet**.
    3.  En **Nivel de seguridad de la zona**, mueva el control deslizante hacia la configuración de seguridad **Alta**. De este modo, se establece el nivel de seguridad para todos los sitios Web que visite en **Alta**.

    **Nota** Si no hay visible un control deslizante, haga clic en **Nivel predeterminado** y, a continuación, mueva el control deslizante hacia **Alta**.

    **Nota** Al establecer el nivel en **Alta**, es posible que algunos sitios web no funcionen correctamente. Si tiene dificultades para utilizar un sitio web después de cambiar esta configuración y está seguro de que el sitio es seguro de utilizar, puede agregarlo a la lista de sitios de confianza. Esto permitirá que el sitio funcione correctamente, incluso con la configuración de seguridad en **Alto**.

    **Consecuencias de la solución provisional:** Preguntar antes de ejecutar los controles ActiveX conlleva efectos secundarios. Muchos sitios web de Internet o una intranet utilizan controles ActiveX para aportar funciones adicionales. Por ejemplo, un sitio de comercio electrónico en línea o el sitio de un banco pueden utilizar controles ActiveX para ofrecer menús, formularios de pedido o incluso movimientos de cuentas. Preguntar antes de ejecutar los controles ActiveX (Pedir datos) es una configuración global que afecta a todos los sitios de Internet e Intranet. Cuando habilite esta solución, se le preguntará para que dé su conformidad con bastante frecuencia. En cada pregunta, si confía en el sitio que está visitando, haga clic en **Sí** para ejecutar los controles ActiveX. Si no desea que se le pregunte para todos estos sitios, siga los pasos de la sección "Agregue sitios en los que confía a la zona de sitios de confianza de Internet Explorer".

    **Agregar sitios en los que confía a la zona de sitios de confianza de Internet Explorer**

    Después de configurar Internet Explorer para exigir que le pregunte antes de ejecutar controles y secuencias de comandos ActiveX en las zonas Internet e Intranet local, puede agregar sitios en los que confíe a la zona Sitios de confianza de Internet Explorer. De esta forma, podrá seguir utilizando como siempre los sitios web de confianza al tiempo que colabora para protegerse de este ataque en los sitios en los que no confía. Se recomienda agregar solamente sitios en los que confíe a la zona Sitios de confianza.

    Para ello, siga estos pasos:

    1.  En Internet Explorer, haga clic en **Herramientas**, **Opciones de Internet** y, a continuación, en la ficha **Seguridad**.
    2.  En el cuadro **Seleccione una zona de contenido web para especificar la configuración de seguridad de la misma**, haga clic en **Sitios de confianza** y, a continuación, en **Sitios**.
    3.  Si desea agregar sitios que no requieren un canal cifrado, haga clic para desactivar la casilla de verificación **Requerir comprobación del servidor (https:) para todos los sitios de esta zona**.
    4.  En el cuadro **Agregar este sitio web a la zona**, escriba la dirección URL de un sitio en el que confíe y haga clic en **Agregar**.
    5.  Repita estos pasos para cada sitio que desee agregar a la zona.
    6.  Haga clic en **Aceptar** dos veces para confirmar los cambios y regresar a Internet Explorer.

    **Nota** Agregue todos los sitios de confianza para los que tenga la certeza de que no realizarán ninguna acción perjudicial en su equipo. En concreto, hay dos sitios que es aconsejable agregar: "\*.windowsupdate.microsoft.com" y "\*.update.microsoft.com" (sin las comillas). Se trata de los sitios que alojarán la actualización y requieren de un control ActiveX para instalarla.

#### Preguntas más frecuentes sobre la vulnerabilidad en CAPICOM.Certificates (CVE-2007-0940):

**¿Cuál es el alcance de esta vulnerabilidad? **
Se trata de una vulnerabilidad de ejecución remota de código. Un atacante que aprovechara esta vulnerabilidad podría lograr de forma remota el control completo de un sistema afectado. De esta forma, un intruso podría instalar programas; ver, cambiar o eliminar datos; o crear cuentas nuevas con todos los derechos de usuario. Por tanto, los usuarios cuyas cuentas estén configuradas con pocos derechos de usuario en el sistema correrían un riesgo menor que aquellos que cuenten con derechos de usuario administrativos.

**¿Cuál es la causa de esta vulnerabilidad? **
La vulnerabilidad viene causada por el modo en que CAPICOM Certificates trata determinadas entradas. En caso de producirse la entrada de datos inesperados, el control ActiveX podría dar lugar a un error que permita la ejecución remota de código.

**¿Qué es CAPICOM.Certificates? **
CAPICOM.Certificates es un control ActiveX que ofrece a los generadores de secuencias de comandos (VBS, ASP, ASP.NET, etc.) un método para cifrar datos basado en la funcionalidad CryptoAPI de Windows subyacente segura. CAPICOM también está disponible para la descarga como [Platform SDK Redistributable: CAPICOM](http://www.microsoft.com/downloads/details.aspx?familyid=860ee43a-a843-462f-abb5-ff88ea5896f6) y, además, es parte del SDK de la plataforma Windows y del kit de controladores de Windows.

**¿Qué debo hacer si desarrollo aplicaciones o software y redistribuyo CAPICOM? **
Necesitará descargar la versión más reciente de [Platform SDK Redistributable: CAPICOM](http://www.microsoft.com/downloads/details.aspx?familyid=860ee43a-a843-462f-abb5-ff88ea5896f6). Esta versión nueva contiene el archivo CAPICOM.dll actualizado que está asociado a esta actualización de seguridad.

**¿Cómo puedo saber si tengo CAPICOM.Certificates instalado y registrado? **
Puede comprobar si tiene CAPICOM instalado buscando CAPICOM.dll en el sistema. Si tiene la versión 2.1.01 o alguna versión anterior, debe actualizar el sistema.

Puede comprobar si tiene alguna combinación de las siguientes claves del Registro con el fin de comprobar si tiene una versión vulnerable del control ActiveX CAPICOM.Certificates registrada en el sistema:

HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes\\CAPICOM.Certificates.1\\CLSID

HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes\\CAPICOM.Certificates.2\\CLSID

HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes\\CAPICOM.Certificates.3\\CLSID

**¿Para qué puede utilizar un atacante esta vulnerabilidad? **
Un atacante que aprovechara con éxito esta vulnerabilidad podría obtener el control completo del sistema afectado. De esta forma, un intruso podría instalar programas; ver, cambiar o eliminar datos; o crear cuentas nuevas con todos los derechos de usuario. Por tanto, los usuarios cuyas cuentas estén configuradas con pocos derechos de usuario en el sistema correrían un riesgo menor que aquellos que cuenten con derechos de usuario administrativos.

**¿Por qué tengo aún la versión anterior de CAPICOM.dll en el sistema tras instalar esta actualización de seguridad? **
Los usuarios pueden haber instalado CAPICOM.DLL de un origen distinto de Microsoft. Un producto que no sea de Microsoft puede haber instalado CAPICOM.DLL. Como la actualización de seguridad no puede determinar el origen de la versión anterior de CAPICOM.dll, permanece en el sistema para preservar la compatibilidad de aplicaciones. La versión anterior no deja el sistema expuesta a esta vulnerabilidad.

**¿Quién podría aprovechar esta vulnerabilidad? **
En el caso de un ataque basado en Web, el atacante tendría que alojar un sitio web que contuviera una página web para intentar aprovechar esta vulnerabilidad. El atacante no podría obligar a los usuarios a visitar un sitio web especialmente diseñado. Por lo tanto, tendría que atraerlos al sitio web; para ello debería, por ejemplo, incitarles a hacer clic en un vínculo que les llevara al sitio web del atacante.

**¿Qué sistemas están más expuestos a esta vulnerabilidad? **
Para que se produzca una acción de este tipo, esta vulnerabilidad requiere que el usuario haya iniciado una sesión y visite un sitio web. Por lo tanto, cualquier sistema que tenga instalado y registrado CAPICOM Certificates en el que se utilice Internet Explorer de forma habitual, como estaciones de trabajo y servidores de Terminal Server, está expuesto a esta vulnerabilidad.

**Estoy ejecutando Internet Explorer 7. ¿Soluciona esto la vulnerabilidad? **
Sí. Los clientes que usan Internet Explorer 7 con la configuración predeterminada no están expuestos mientras no activen el control de CAPICOM Certificates a través de la característica ActiveX opcional en la zona Internet. Sin embargo, si un cliente ha usado este control ActiveX en una versión anterior de Internet Explorer, entonces este control ActiveX está habilitado para funcionar en Internet Explorer 7, incluso si el cliente no lo ha aprobado explícitamente mediante la característica ActiveX opcional.

**¿Qué es la característica ActiveX opcional de Internet Explorer 7? **
Internet Explorer 7 incluye la característica ActiveX opcional que significa que prácticamente todos los controles ActiveX preinstalados están desactivados de forma predeterminada. A los usuarios se les pregunta en la barra de información antes de que puedan tener acceso a un control ActiveX instalado anteriormente que todavía no se haya usado en Internet. De este modo, un usuario puede permitir o denegar el acceso según cada control. Para obtener más información sobre ésta y otras características, consulte la [página de características de Windows Internet Explorer 7](http://www.microsoft.com/windows/ie/ie7/about/features/default.mspx).

**Estoy ejecutando Internet Explorer en Windows Server 2003. ¿Soluciona esto la vulnerabilidad? **
Sí. De forma predeterminada, Internet Explorer en Windows Server 2003 se ejecuta en un modo restringido conocido como [Configuración de seguridad mejorada](http://msdn.microsoft.com/library/default.asp?url=/workshop/security/szone/overview/esc_changes.asp). Este modo establece el nivel de seguridad para la zona Internet en Alto. Esto constituye un factor atenuante para sitios web que no se han agregado a la zona de sitios de confianza de Internet Explorer. Vea la sección P+F correspondiente a esta actualización de seguridad para obtener más información acerca de la configuración de seguridad mejorada de Internet Explorer.

**¿Qué es la configuración de seguridad mejorada de Internet Explorer? **
Se trata de un grupo de valores preconfigurados de Internet Explorer que reducen la posibilidad de que los usuarios o administradores descarguen o ejecuten contenido Web peligroso en un servidor. La configuración de seguridad mejorada de Internet Explorer reduce esta amenaza al modificar numerosos valores de configuración relacionados con la seguridad, incluidos los de las fichas Seguridad y Opciones Avanzadas en Opciones de Internet. Algunas de las modificaciones principales son las siguientes:

-   El nivel de seguridad para la zona Internet está establecido en **Alto**. Esta configuración deshabilita las secuencias de comandos, los componentes de ActiveX, la máquina virtual de Microsoft (Microsoft VM), el contenido HTML y las descargas de archivos.
-   Se ha deshabilitado la detección automática de sitios de intranet. Esta configuración asigna a la zona Internet todos los sitios web de intranet y todas las rutas de acceso que cumplen la Convención de nomenclatura universal (UNC, Universal Naming Convention) y que no aparecen enumeradas de forma específica en la zona Intranet local.
-   Se han deshabilitado la instalación a petición y las extensiones de explorador que no pertenecen a Microsoft. Esta configuración impide que las páginas web instalen componentes de modo automático y que se ejecuten las extensiones que no sean de Microsoft.
-   Se ha deshabilitado el contenido multimedia. Esta configuración impide que se ejecuten archivos de música, animación y clips de vídeo.

Si desea obtener más información sobre la Configuración de seguridad mejorada de Internet Explorer, consulte la guía de administración de la configuración de seguridad mejorada de Internet Explorer, que se puede encontrar en el siguiente [sitio web](http://www.microsoft.com/downloads/details.aspx?familyid=d41b036c-e2e1-4960-99bb-9757f7e9e31b&displaylang=en) (en inglés).

**¿Cómo funciona esta actualización? **
La actualización elimina la vulnerabilidad al modificar la manera en que el control CAPICOM.Certificates realiza la validación de parámetros. Corrige también los problemas adicionales descubiertos a través de investigaciones internas.

**En el momento de publicar este boletín de seguridad, ¿se había divulgado ya esta vulnerabilidad? **
No. Microsoft recibió información acerca de esta vulnerabilidad a través de una fuente responsable.

**En el momento de publicar este boletín de seguridad, ¿había recibido Microsoft algún informe que indicase que se estaba utilizando esta vulnerabilidad? **
No. En el momento de publicar este boletín de seguridad, Microsoft no había recibido ninguna información que indicara que esta vulnerabilidad se hubiera utilizado para atacar a clientes y no tenía constancia de que se hubiera publicado código demostrativo.

Información sobre la actualización de seguridad
-----------------------------------------------

<span></span>
**Software afectado:**

Para obtener información sobre la actualización de seguridad específica para su software afectado, vea la sección adecuada:

#### CAPICOM y BizTalk Server 2004

**Requisitos previos**
Esta actualización de seguridad requiere que CAPICOM Certificates esté instalado y registrado. BizTalk Server 2004 instala CAPICOM Certificates. Esta actualización funcionará con instalaciones independientes y de BizTalk Server 2004. Existen productos que no son de Microsoft que pueden redistribuir e instalar CAPICOM.dll. Consulte la pregunta **“¿Cómo puedo saber si tengo Capicom.Certificates instalado y registrado en mi equipo?”** para obtener más detalles.

**Inclusión en futuros Service Packs**
La actualización para este problema puede incluirse en un Service Pack futuro o en un conjunto de actualizaciones para Microsoft BizTalk Server 2004.

**Información sobre la instalación**

Esta actualización de seguridad admite los parámetros de instalación que se indican a continuación.

<table class="dataTable">
<caption>
Parámetros de instalación de la actualización de seguridad admitidos
</caption>
<tr class="thead">
<th>
Parámetro
</th>
<th>
Descripción
</th>
</tr>
<tr>
<th colspan="2">
Modos de instalación
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/q**
</td>
<td style="border:1px solid black;">
Especifica el modo silencioso o suprime los mensajes cuando se están extrayendo los archivos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/q:u**
</td>
<td style="border:1px solid black;">
Especifica el modo silencioso de usuario, que presenta al usuario algunos cuadros de diálogo.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/q:a**
</td>
<td style="border:1px solid black;">
Especifica el modo silencioso de administrador, que no muestra ningún cuadro de diálogo al usuario.
</td>
</tr>
<tr>
<th colspan="2">
Opciones especiales
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/t:**&lt;ruta de acceso completa&gt;
</td>
<td style="border:1px solid black;">
Especifica la carpeta de destino para extraer los archivos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/c**
</td>
<td style="border:1px solid black;">
Extrae los archivos sin instalarlos. Si no se especifica /T: ruta de acceso no especificada; aparece un mensaje para pedir la carpeta de destino
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/c:**&lt;Cmd&gt;
</td>
<td style="border:1px solid black;">
Reemplazar el comando de instalación definido por el autor. Especifica la ruta de acceso y el nombre del archivo .inf o .exe de la instalación.
</td>
</tr>
</table>
 
**Nota** Estos parámetros no funcionan necesariamente con todas las actualizaciones. Si un parámetro no está disponible, indica que esa funcionalidad se necesita para la correcta instalación de la actualización. Si la instalación no se realiza correctamente, debería consultar con el servicio de soporte técnico para saber el motivo.

Para obtener información adicional acerca de los parámetros de instalación admitidos, vea el [artículo 197147 de Microsoft Knowledge Base](http://support.microsoft.com/kb/197147).

**Información sobre la implementación**

Para instalar la actualización de seguridad sin intervención del usuario, escriba la línea de comandos siguiente en el símbolo del sistema:

**CAPICOM-KB931906-v2102 /q:a**

Para obtener más información acerca de cómo implementar esta actualización de seguridad mediante el uso de Software Update Services, visite el [sitio web de Software Update Services](http://go.microsoft.com/fwlink/?linkid=21125). Para obtener información acerca de cómo implementar esta actualización de seguridad con Windows Server Update Services, visite el sitio Web de [Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Esta actualización de seguridad estará también disponible en el [sitio web Windows Update](http://update.microsoft.com/microsoftupdate).

**Requisito de reinicio**

Esta actualización no requiere reinicio.

**Información sobre la eliminación**

Para eliminar esta actualización de seguridad, utilice la herramienta Agregar o quitar programas del Panel de control.

**Información sobre archivos**

La versión en inglés de esta actualización de seguridad tiene los atributos de archivo indicados en la tabla siguiente. Las fechas y horas de estos archivos se muestran en el horario universal coordinado (UTC). Cuando se consulta la información de archivo, ésta se convierte al horario local. Para averiguar la diferencia entre el horario universal coordinado y el local, utilice la ficha **Zona horaria** en la herramienta Fecha y hora del Panel de control.

| Nombre de archivo | Versión | Fecha       | Hora  | Tamaño  |
|-------------------|---------|-------------|-------|---------|
| License.mht       | NA      | 26-Feb-2007 | 23:16 | 142,534 |
| License.rtf       | NA      | 26-Feb-2007 | 23:16 | 134,577 |
| CAPICOM.dll       | 2.1.0.2 | 11-Apr-2007 | 18:11 | 511,328 |

**Comprobación de que se ha aplicado la actualización**

-   **Comprobación de la versión del archivo**

    **Nota** Puesto que existen varias versiones de Microsoft Windows, los pasos que se indican a continuación pueden ser diferentes en su equipo. En tal caso, consulte la documentación del producto para ejecutar los pasos necesarios.

    1.  Haga clic en **Inicio** y, después, en **Buscar**.
    2.  En el panel **Resultados de la búsqueda**, haga clic en **Todos los archivos y carpetas** del **Asistente para búsqueda**.
    3.  En el cuadro **Todo o parte del nombre de archivo**, escriba un nombre de archivo de la tabla de información de archivos correspondiente y, a continuación, haga clic en **Buscar**.
    4.  En la lista de archivos, haga clic con el botón secundario del mouse en un nombre de archivo de la tabla de información de archivos correspondiente y, después, haga clic en **Propiedades**.
        **Nota** Según la versión del sistema operativo o de los programas instalados, cabe la posibilidad de que algunos de los archivos enumerados en la tabla de información de archivos no estén instalados.
    5.  En la ficha **Versión**, determine la versión del archivo instalado en el equipo por comparación con la versión documentada en la tabla de información de archivos correspondiente.
        **Nota** Los atributos distintos a la versión del archivo pueden cambiar durante la instalación. La comparación de otros atributos de los archivos con los datos de la tabla de información de archivos no constituye un método apropiado para comprobar que se haya aplicado la actualización. Además, en ciertos casos, el nombre de los archivos se puede cambiar durante la instalación. Si no aparece información de la versión o del archivo, recurra a otro de los métodos disponibles para comprobar la instalación de la actualización.

-   **Comprobación de las claves del Registro**

    También podría comprobar los archivos que ha instalado esta actualización de seguridad revisando la siguiente clave del Registro:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes\\CAPICOM.Certificates.4\\CLSID

### Información adicional:

**Agradecimientos**

Microsoft [muestra su agradecimiento](http://go.microsoft.com/fwlink/?linkid=21127) a todas las personas que han trabajado con nosotros para proteger a los clientes:

-   Chris Ries, de [VigilantMinds Inc.](http://www.vigilantminds.com/), por informar de la vulnerabilidad de CAPICOM.Certificates (CVE-2007-0940)

**Obtención de otras actualizaciones de seguridad:**

Las actualizaciones para otros problemas de seguridad están disponibles en las ubicaciones siguientes:

-   Hay actualizaciones de seguridad disponibles en el [Centro de descarga de Microsoft](http://www.microsoft.com/downloads/search.aspx?displaylang=es). Si realiza una búsqueda de las palabras clave “revisión de seguridad” podrá encontrarlas fácilmente.
-   Hay disponibles actualizaciones para las plataformas de usuarios en el [sitio web Windows Update](http://go.microsoft.com/fwlink/?linkid=40747) de Microsoft.

**Soporte técnico:**

-   Puede solicitar soporte técnico en los [Servicios de soporte técnico de Microsoft](http://support.microsoft.com/default.aspx?scid=fh;es-es;incidentsubmit) o a través del teléfono 902 197 198.
-   Los clientes internacionales pueden recibir soporte técnico en las subsidiarias de Microsoft de sus países. Las llamadas de soporte técnico relacionadas con las actualizaciones de seguridad son gratuitas. Para obtener más información acerca de cómo ponerse en contacto con Microsoft en relación con problemas de soporte técnico, visite el [sitio web de soporte técnico internacional de Microsoft](http://go.microsoft.com/fwlink/?linkid=21155).

**Recursos de seguridad:**

-   El sitio web [Microsoft TechNet Security](http://www.microsoft.com/spain/technet/seguridad/default.mspx) proporciona información adicional acerca de la seguridad de los productos de Microsoft.
-   [Centro de administración de actualizaciones de TechNet](http://go.microsoft.com/fwlink/?linkid=69903)
-   [Microsoft Software Update Services](http://go.microsoft.com/fwlink/?linkid=21133)
-   [Microsoft Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120)
-   [Microsoft Baseline Security Analyzer](http://www.microsoft.com/spain/technet/seguridad/herramientas/mbsa.mspx) (MBSA)
-   [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130)
-   [Microsoft Update](http://update.microsoft.com/microsoftupdate)
-   Catálogo de actualizaciones de Windows: Para obtener más información sobre el Catálogo de actualizaciones de Windows, consulte el [artículo 323166 de Microsoft Knowledge Base](http://support.microsoft.com/kb/323166).
-   [Office Update](http://go.microsoft.com/fwlink/?linkid=21135)

**Software Update Services:**

Software Update Services (SUS) permite a los administradores implementar con rapidez y confiabilidad las actualizaciones críticas y de seguridad más recientes en servidores basados en Windows 2000 y Windows Server 2003, y en sistemas de escritorio donde se ejecute Windows 2000 Professional o Windows XP Professional.

Para obtener más información acerca de cómo implementar actualizaciones de seguridad con Software Update Services, visite el [sitio web de Software Update Services](http://go.microsoft.com/fwlink/?linkid=21133).

**Windows Server Update Services:**

Windows Server Update Services (WSUS) permite a los administradores implementar con rapidez y fiabilidad las actualizaciones críticas y de seguridad más recientes en sistemas operativos Windows 2000 y versiones posteriores, Office XP y versiones posteriores, Exchange Server 2003 y SQL Server 2000 hasta Windows 2000 y sistemas operativos posteriores.

Para obtener más información acerca de cómo implementar actualizaciones de seguridad con Windows Server Update Services, visite el [sitio web de Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120).

**Systems Management Server:**

Microsoft Systems Management Server (SMS) ofrece una solución empresarial altamente configurable para la administración de las actualizaciones. Mediante SMS, los administradores pueden identificar los sistemas basados en Windows que necesitan actualizaciones de seguridad, así como realizar la implementación controlada de las actualizaciones en la empresa con una repercusión mínima para los usuarios finales. Para obtener más información acerca de cómo pueden utilizar SMS 2003 los administradores para implementar actualizaciones de seguridad, visite el [sitio web de administración de revisiones de seguridad de SMS 2003](http://go.microsoft.com/fwlink/?linkid=22939). Los usuarios de SMS 2.0 también pueden usar [Software Updates Service Feature Pack](http://go.microsoft.com/fwlink/?linkid=33340) como ayuda para la implementación de actualizaciones de seguridad. Para obtener más información acerca de SMS, visite el [sitio web de SMS](http://www.microsoft.com/spain/smserver/default.mspx).

**Nota** SMS usa las herramientas Microsoft Baseline Security Analyzer, Microsoft Office Detection Tool y Enterprise Update Scan Tool para proporcionar un amplio soporte técnico en la detección e implementación de las actualizaciones indicadas en los boletines de seguridad. Puede que estas herramientas no detecten algunas actualizaciones de software. Los administradores pueden usar las prestaciones de inventario de SMS en estos casos para concretar qué actualizaciones se deben aplicar en cada sistema. Para obtener más información acerca de este procedimiento, visite el siguiente [sitio web](http://go.microsoft.com/fwlink/?linkid=33341), en inglés. Algunas actualizaciones de seguridad pueden requerir derechos administrativos y que se reinicie el sistema. Los administradores pueden usar la utilidad Elevated Rights Deployment Tool (disponible en [SMS 2003 Administration Feature Pack](http://go.microsoft.com/fwlink/?linkid=33387) y en [SMS 2.0 Administration Feature Pack](http://go.microsoft.com/fwlink/?linkid=21161)) para instalar estas actualizaciones.

**Renuncia:**

La información proporcionada en Microsoft Knowledge Base se suministra "tal cual", sin garantía de ningún tipo. Microsoft renuncia al otorgamiento de toda garantía, tanto expresa como implícita, incluidas las garantías de comerciabilidad e idoneidad para un determinado fin. Ni Microsoft Corporation ni sus proveedores se responsabilizarán en ningún caso de daños directos, indirectos, incidentales, consecuenciales, pérdida de beneficios o daños especiales, aun en el supuesto de que se hubiera informado a Microsoft Corporation o a sus proveedores de la posibilidad de dichos daños. Algunos estados de Estados Unidos no permiten la exclusión o limitación de responsabilidad por daños consecuenciales o incidentales, y, por tanto, la limitación anterior puede no ser aplicable en su caso.

**Revisiones:**

-   V1.0 (8 de mayo de 2007): Publicación del boletín.

*Built at 2014-04-18T01:50:00Z-07:00*
