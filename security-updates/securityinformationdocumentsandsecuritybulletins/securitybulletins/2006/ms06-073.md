---
TOCTitle: 'MS06-073'
Title: 'Boletín de seguridad de Microsoft MS06-073 - Crítica'
ms:assetid: 'ms06-073'
ms:contentKeyID: 61225281
ms:mtpsurl: 'https://technet.microsoft.com/es-ES/library/ms06-073(v=Security.10)'
---

Boletín de seguridad de Microsoft MS06-073 - Crítica
====================================================

Una vulnerabilidad en Visual Studio 2005 podría permitir la ejecución remota de código (925674)
-----------------------------------------------------------------------------------------------

Publicado: martes, 12 de diciembre de 2006

**Versión:** 1.0

#### Resumen

**Quién debería leer este documento:** Los clientes que utilizan Microsoft Visual Studio 2005

**Consecuencia de la vulnerabilidad:** Ejecución remota de código

**Gravedad máxima:** Crítica

**Recomendación:** Los clientes deberían aplicar esta actualización inmediatamente.

**Actualizaciones de seguridad reemplazadas:** Ninguna

**Advertencias:** En el [artículo 925674 de Microsoft Knowledge Base](http://support.microsoft.com/kb/925674) se señalan los problemas detectados que pueden experimentar los clientes al instalar esta actualización de seguridad. Se documentan asimismo las soluciones propuestas. Para obtener más información, vea el [artículo 925674 de Microsoft Knowledge Base](http://support.microsoft.com/kb/925674).

**Ubicaciones de descarga de la actualización de seguridad y productos probados:**

**Software afectado:**

-   Microsoft Estudio Visual 2005: [Descargar la actualización](http://www.microsoft.com/downloads/details.aspx?familyid=c2682c53-8e9a-4c7d-b782-be78512dcbfa)

**Software no afectado:**

-   Microsoft Visual Studio 6.0 Service Pack 6
-   Microsoft Visual Studio .NET 2002 Service Pack 1
-   Microsoft Visual Studio .NET 2003 Service Pack 1

**Nota** No todas las versiones de Visual Studio 2005 incluyen el archivo afectado. No le afectará esta vulnerabilidad si no tiene wmiscriptutils.dll en el sistema. Microsoft Visual Studio Express 2005 no incluye este archivo.

Los programas de esta lista han sido probados para determinar si las versiones están afectadas. Por lo que se refiere a otras versiones, quizá ya no sean compatibles con las actualizaciones de seguridad o no se vean afectadas. Para determinar el ciclo de vida del soporte técnico de su producto y versión, visite el sitio web [Ciclo de vida del soporte técnico de Microsoft](http://go.microsoft.com/fwlink/?linkid=21742).

### Información general

Resumen ejecutivo
-----------------

**Resumen ejecutivo:**

Esta actualización resuelve una vulnerabilidad de la que se ha informado de forma pública. La vulnerabilidad se documenta en este boletín, en el apartado "Detalles de la vulnerabilidad".

Un atacante que aprovechara esta vulnerabilidad podría lograr el control completo de un sistema afectado. De esta forma, un intruso podría instalar programas; ver, cambiar o eliminar datos; o crear cuentas nuevas con todos los derechos de usuario.

Si un usuario inicia sesión con derechos de usuario administrativos, un intruso que aprovechara esta vulnerabilidad podría lograr el control completo de un sistema afectado. De esta forma, un intruso podría instalar programas; ver, cambiar o eliminar datos; o crear cuentas nuevas con todos los derechos de usuario. Por tanto, los usuarios cuyas cuentas estén configuradas con pocos derechos de usuario en el sistema correrían un riesgo menor que aquellos que cuenten con derechos de usuario administrativos.

Es recomendable que los clientes apliquen la actualización inmediatamente.

**Gravedad e identificadores de vulnerabilidad:**

 
<p> </p>
<table style="border:1px solid black;">
<thead>
<tr class="header">
<th style="border:1px solid black;" >Identificadores de vulnerabilidad</th>
<th style="border:1px solid black;" >Consecuencia de la vulnerabilidad</th>
<th style="border:1px solid black;" >Visual Studio 2005</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">Vulnerabilidad de agente de objetos WMI: <a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2006-4704">CVE-2006-4704</a></td>
<td style="border:1px solid black;">Ejecución remota de código<br />
</td>
<td style="border:1px solid black;">Crítica</td>
</tr>
</tbody>
</table>
  
**Nota** De forma predeterminada, Internet Explorer en Windows Server 2003 se ejecuta en un modo restringido conocido como Configuración de seguridad mejorada. Este modo soluciona esta vulnerabilidad. Vea la sección P+F correspondiente a esta actualización de seguridad para obtener más información acerca de la configuración de seguridad mejorada de Internet Explorer.
  
Esta [clasificación](http://go.microsoft.com/fwlink/?linkid=21140) está basada en los tipos de sistemas afectados por la vulnerabilidad, sus patrones típicos de implementación y el efecto que podría tener un ataque en el que se aprovechara la vulnerabilidad.
  
Preguntas más frecuentes (P+F) relacionadas con esta actualización de seguridad  
-------------------------------------------------------------------------------
  
**¿Qué actualizaciones reemplaza esta versión?**  
Esta actualización de seguridad no reemplaza a ninguna actualización de seguridad anterior.
  
**¿Se puede utilizar Microsoft Baseline Security Analyzer (MBSA) para determinar si esta actualización es necesaria?**  
  
La tabla siguiente proporciona el resumen de detección MBSA correspondiente a esta actualización de seguridad.
  
| Producto           | MBSA 1.2.1 | EST | MBSA 2.0 |  
|--------------------|------------|-----|----------|  
| Visual Studio 2005 | No         | Sí  | Sí       |
  
Para obtener más información acerca de MBSA, visite el [sitio web de MBSA](http://www.microsoft.com/spain/technet/seguridad/herramientas/mbsa.mspx).
  
Para obtener más información acerca de los programas que Microsoft Update y MBSA 2.0 no detectan actualmente, consulte el [artículo 895660 de Microsoft Knowledge Base](http://support.microsoft.com/kb/895660).
  
Para obtener información más detallada, consulte el [artículo 910723 de Microsoft Knowledge Base](http://support.microsoft.com/kb/910723).
  
**¿Qué es la** **herramienta** **Enterprise Update Scan Tool (EST)?**  
Como parte de un compromiso continuo para proporcionar herramientas de detección relacionadas con actualizaciones de seguridad de tipo boletín, Microsoft ofrece una herramienta de detección independiente siempre que Microsoft Baseline Security Analyzer (MBSA) y la herramienta Office Detection Tool (ODT) no pueden detectar si la actualización es necesaria para un ciclo de publicación de MSRC. Esta herramienta independiente se denomina Enterprise Update Scan Tool (EST) y está diseñada para los administradores de empresa. Cuando se crea una versión de la herramienta Enterprise Update Scan Tool para un boletín específico, los clientes pueden ejecutar la herramienta desde una interfaz de línea de comandos y ver los resultados del archivo de salida XML. Para ayudar a los clientes a utilizar mejor la herramienta, se proporcionará documentación detallada con la misma. También existe una versión de la herramienta que ofrece una experiencia integrada para los administradores de SMS.
  
**¿Se puede utilizar una versión de la** **herramienta** **Enterprise Update Scan Tool (EST) para determinar si esta actualización es necesaria?**  
Sí. Microsoft ha creado una versión de la herramienta EST que puede determinar si se necesita aplicar esta actualización. Para obtener vínculos de descarga e información adicional acerca de la versión de EST que se publica este mes, vea el [artículo 894193 de Microsoft Knowledge Base](http://support.microsoft.com/kb/894193). Es aconsejable que los clientes de SMS consulten la pregunta "¿Se puede utilizar Systems Management Server (SMS) para determinar si esta actualización es necesaria?" de la sección Preguntas más frecuentes para obtener más información acerca de SMS y EST.
  
**¿Se puede utilizar Systems Management Server (SMS) para determinar si esta actualización es necesaria?**  
La tabla siguiente proporciona el resumen de detección SMS correspondiente a esta actualización de seguridad.
  
| Producto           | SMS 2.0                     | SMS 2003 |  
|--------------------|-----------------------------|----------|  
| Visual Studio 2005 | Sí (con la herramienta EST) | Sí       |
  
SMS 2.0 y SMS 2003 Software Update Services (SUS) Feature Pack pueden usar MBSA 1.2.1 para la detección y, por lo tanto, tener la misma limitación que la indicada anteriormente en este boletín con relación a los programas que no detecta MBSA 1.2.1.
  
En cuanto a SMS 2.0, SMS puede usar el SMS SUS Feature Pack, que incluye la herramienta Security Update Inventory Tool (SUIT), para detectar actualizaciones de seguridad. SMS UIT usa el motor de MBSA 1.2.1 para la detección. Para obtener más información acerca de SUIT, visite el siguiente [sitio web de Microsoft](http://support.microsoft.com/kb/894154/). Para obtener más información acerca de las limitaciones de SUIT, consulte el [artículo 306460 de Microsoft Knowledge Base.](http://support.microsoft.com/kb/306460/) SMS SUS Feature Pack incluye también la herramienta Microsoft Office Inventory Tool, que permite detectar las actualizaciones requeridas para las aplicaciones de Microsoft Office.
  
En cuanto a SMS 2003, SMS puede utilizar la herramienta SMS 2003 Inventory Tool for Microsoft Updates (ITMU) para detectar actualizaciones de seguridad proporcionadas por [Microsoft Update](http://update.microsoft.com/microsoftupdate) y compatibles con [Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Para obtener más información acerca de SMS 2003 ITMU, visite el siguiente [sitio web de Microsoft](http://go.microsoft.com/fwlink/?linkid=72181). Además, SMS 2003 puede usar Microsoft Office Inventory Tool con el fin de detectar las actualizaciones requeridas para las aplicaciones de Microsoft Office.
  
Para obtener más información acerca de SMS, visite el [sitio web de SMS](http://go.microsoft.com/fwlink/?linkid=21158).
  
Para obtener información más detallada, consulte el [artículo 910723 de Microsoft Knowledge Base](http://support.microsoft.com/kb/910723).
  
**¿Se puede utilizar SMS para determinar si hay otros programas instalados que tengan que actualizarse?**  
Sí. SMS puede ayudar a detectar si hay otros programas instalados que puedan tener instalada una versión del componente vulnerable. SMS puede determinar si existe el archivo wmiscriptutils.dll. Actualice todas las versiones de wmiscriptutils.dll que sean anteriores a la 8.0.50727.236.
  
**¿Cuáles son los problemas detectados que pueden experimentar los clientes al instalar esta actualización de seguridad?**  
En el [artículo 925674 de Microsoft Knowledge Base](http://support.microsoft.com/kb/925674) se señalan los problemas detectados que pueden experimentar los clientes al instalar esta actualización de seguridad. Se documentan asimismo las soluciones propuestas. Para obtener más información, vea el [artículo 925674 de Microsoft Knowledge Base](http://support.microsoft.com/kb/925674).
  
Detalles de la vulnerabilidad  
-----------------------------
  
#### Vulnerabilidad de agente de objetos WMI (CVE-2006-4704):
  
Existe una vulnerabilidad de ejecución remota de código en el control del agente de objetos WMI que el asistente de WMI usa en Visual Studio 2005. Un atacante podría aprovechar esta vulnerabilidad mediante la creación de una página web especialmente diseñada que podría permitir la ejecución remota de código si el usuario la visita. Un atacante que aprovechara esta vulnerabilidad podría lograr el control completo de un sistema afectado.
  
#### Factores atenuantes para la vulnerabilidad de agente de objetos WMI (CVE-2006-4704):
  
-   En el caso de un ataque basado en web, el intruso podría alojar un sitio web que contuviera una página web para aprovechar esta vulnerabilidad. Además, los sitios web vulnerables y los sitios web que aceptan o alojan contenido o anuncios proporcionados por el usuario podrían incluir contenido especialmente diseñado que permita aprovechar esta vulnerabilidad. Sin embargo, el atacante no podría en ningún caso obligar a los usuarios a visitar estos sitios web. Por lo tanto, tendría que atraerlos al sitio web; por lo general, convenciéndoles para que hagan clic en un vínculo de un mensaje de correo electrónico o de Instant Messenger que lleve a los usuarios al sitio web del atacante.  
-   De forma predeterminada, este control ActiveX no está incluido en la lista predeterminada de controles ActiveX permitidos en Internet Explorer 7. Sólo los clientes que han aprobado explícitamente este control mediante la característica ActiveX opcional están expuestos a los intentos de aprovechar esta vulnerabilidad. Sin embargo, si un cliente ha usado este control ActiveX en una versión anterior de Internet Explorer, entonces este control ActiveX está habilitado para funcionar en Internet Explorer 7, incluso si el cliente no lo ha aprobado explícitamente mediante la característica ActiveX opcional.  
-   Un intruso que aprovechara esta vulnerabilidad podría conseguir el mismo nivel de derechos de usuario que el usuario local. Por tanto, los usuarios cuyas cuentas estén configuradas con pocos derechos de usuario en el sistema correrían un riesgo menor que aquellos que cuenten con derechos de usuario administrativos.  
-   La zona Sitios restringidos ayuda a reducir los ataques que podrían aprovechar esta vulnerabilidad al impedir que se usen controles ActiveX y secuencias de comandos ActiveX cuando se lee correo electrónico HTML. Sin embargo, si un usuario hace clic en un vínculo de un mensaje de correo electrónico, aún podría ser vulnerable a este problema ante la posibilidad de un ataque basado en web.  
       
    De forma predeterminada, todas las versiones admitidas de Microsoft Outlook y Microsoft Outlook Express abren los mensajes de correo electrónico HTML en la zona Sitios restringidos. La zona Sitios restringidos ayuda a reducir los ataques que podrían aprovechar esta vulnerabilidad al impedir que se usen controles ActiveX y secuencias de comandos ActiveX cuando se lee correo electrónico HTML. Sin embargo, si un usuario hace clic en un vínculo de un mensaje de correo electrónico, aún podría ser vulnerable a este problema ante la posibilidad de un ataque basado en web.  
-   De forma predeterminada, Internet Explorer en Windows Server 2003 se ejecuta en un modo restringido conocido como [Configuración de seguridad mejorada](http://msdn.microsoft.com/library/default.asp?url=/workshop/security/szone/overview/esc_changes.asp). Este modo establece el nivel de seguridad para la zona Internet en Alto. Esto constituye un factor atenuante para sitios web que no se han agregado a la zona de sitios de confianza de Internet Explorer. Vea la sección P+F correspondiente a esta actualización de seguridad para obtener más información acerca de la configuración de seguridad mejorada de Internet Explorer.
  
#### Soluciones provisionales para la vulnerabilidad de agente de objetos WMI (CVE-2006-4704):
  
Microsoft ha probado las siguientes soluciones provisionales. Aunque estas soluciones provisionales no corrigen la vulnerabilidad subyacente, ayudan a bloquear los tipos de ataque conocidos. Cuando una solución temporal reduce la funcionalidad, se identifica en la siguiente sección.
  
-   **Deshabilitar los intentos de ejecutar el control de agente de objetos WMI**
  
    Puede deshabilitar los intentos de ejecutar este control ActiveX en Internet Explorer configurando el bit de interrupción del control en el Registro.
  
    **Advertencia** Si utiliza el Editor del Registro incorrectamente, puede provocar problemas graves que conlleven la reinstalación del sistema operativo. Microsoft no le garantiza que pueda resolver los problemas provocados por el uso incorrecto del Editor del Registro. El uso del Editor del Registro es responsabilidad suya.
  
    Si desea ver el procedimiento detallado para impedir que un control se ejecute en Internet Explorer, consulte el [artículo 240797 de Microsoft Knowledge Base](http://support.microsoft.com/kb/240797). Siga estos pasos para crear un valor de indicadores de compatibilidad en el Registro para evitar que se ejecute un objeto COM en Internet Explorer.
  
    Para configurar el bit de interrupción para un CLSID con un valor de {7F5B7F63-F06F-4331-8A26-339E03C0AE3D}, pegue el texto siguiente en un editor de textos como el Bloc de notas. A continuación, guarde el archivo con la extensión de nombre de archivo .reg.
  
    Windows Registry Editor Version 5.00  
    \[HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{7F5B7F63-F06F-4331-8A26-339E03C0AE3D}\]  
    "Compatibility Flags"=dword:00000400
  
    Puede aplicar este archivo .reg a sistemas individuales si hace doble clic en él. También puede aplicarlo entre dominios mediante Directiva de grupo. Para obtener más información acerca de directivas de grupo, consulte los siguientes sitios web de Microsoft:
  
    Colección de directivas de grupo
  
    ¿Qué es el editor de objetos de directiva de grupo?
  
    Configuración y herramientas básicas de directiva de grupo
  
    **Nota:** Debe reiniciar Internet Explorer para que los cambios surtan efecto.
  
    **Consecuencias de la solución provisional**: Es posible que el Asistente de WMI en Visual Studio 2005 no se muestre ni funcione correctamente.
  
-   **Configurar Internet Explorer de forma que se pregunte al usuario antes de ejecutar o deshabilitar controles ActiveX en las zonas de seguridad de Internet e Intranet local**
  
    Puede colaborar en la protección contra esta vulnerabilidad modificando la configuración Internet Explorer de modo que se pregunte antes de ejecutar controles de ActiveX. Para ello, siga estos pasos:
  
    1.  En Internet Explorer, haga clic en **Opciones de Internet** en el menú **Herramientas**.  
    2.  Haga clic en la ficha **Seguridad**.  
    3.  Haga clic en **Internet** y, a continuación, haga clic en **Nivel personalizado**.  
    4.  En **Configuración**, en la sección **Controles y complementos de ActiveX**, en **Ejecutar controles y complementos de ActiveX**, haga clic en **Pedir datos** o **Deshabilitar**, y, a continuación, haga clic en **Aceptar**.  
    5.  Haga clic en **Intranet local** y, a continuación, haga clic en **Nivel personalizado**.  
    6.  En **Configuración**, en la sección **Controles y complementos de ActiveX**, en **Ejecutar controles y complementos de ActiveX**, haga clic en **Pedir datos** o **Deshabilitar**, y, a continuación, haga clic en **Aceptar**.  
    7.  Haga clic en **Aceptar** dos veces para volver a Internet Explorer.
  
    **Consecuencias de la solución provisional:** Preguntar antes de ejecutar los controles ActiveX conlleva efectos secundarios. Muchos sitios web de Internet o una intranet utilizan controles ActiveX para aportar funciones adicionales. Por ejemplo, un sitio de comercio electrónico en línea o el sitio de un banco pueden utilizar controles ActiveX para ofrecer menús, formularios de pedido o incluso movimientos de cuentas. Preguntar antes de ejecutar los controles ActiveX (Pedir datos) es una configuración global que afecta a todos los sitios de Internet e Intranet. Cuando habilite esta solución, se le preguntará para que dé su conformidad con bastante frecuencia. En cada pregunta, si confía en el sitio que está visitando, haga clic en **Sí** para ejecutar los controles ActiveX. Si no desea que se le pregunte para todos estos sitios, siga los pasos de la sección "Agregue sitios en los que confía a la zona de sitios de confianza de Internet Explorer".
  
    **Agregar sitios en los que confía a la zona de sitios de confianza de Internet Explorer**
  
    Después de configurar Internet Explorer para exigir que le pregunte antes de ejecutar controles y secuencias de comandos ActiveX en las zonas Internet e Intranet local, puede agregar sitios en los que confíe a la zona Sitios de confianza de Internet Explorer. De esta forma, podrá seguir utilizando como siempre los sitios web de confianza al tiempo que colabora para protegerse de este ataque en los sitios en los que no confía. Se recomienda agregar solamente sitios en los que confíe a la zona Sitios de confianza.
  
    Para ello, siga estos pasos:
  
    1.  En Internet Explorer, haga clic en **Herramientas**, **Opciones de Internet** y, a continuación, en la ficha **Seguridad**.  
    2.  En el cuadro **Seleccione una zona de contenido web para especificar la configuración de seguridad de la misma**, haga clic en **Sitios de confianza** y, a continuación, en **Sitios**.  
    3.  Si desea agregar sitios que no requieren un canal cifrado, haga clic para desactivar la casilla de verificación **Requerir comprobación del servidor (https:) para todos los sitios de esta zona**.  
    4.  En el cuadro **Agregar este sitio web a la zona**, escriba la dirección URL de un sitio en el que confíe y haga clic en **Agregar**.  
    5.  Repita estos pasos para cada sitio que desee agregar a la zona.  
    6.  Haga clic en **Aceptar** dos veces para confirmar los cambios y regresar a Internet Explorer.
  
    **Nota** Agregue todos los sitios de confianza para los que tenga la certeza de que no realizarán ninguna acción perjudicial en su equipo. En concreto, hay dos sitios que es aconsejable agregar: "\*.windowsupdate.microsoft.com" y "\*.update.microsoft.com" (sin las comillas). Se trata de los sitios que alojarán la actualización y requieren de un control ActiveX para instalarla.
  
-   **Configurar las zonas de seguridad de Internet e Intranet local en “Alta”, de forma que se pregunte antes de ejecutar controles ActiveX y secuencias de comandos ActiveX en estas zonas**
  
    Puede colaborar en la protección contra esta vulnerabilidad modificando la configuración de la zona de seguridad de Internet para que solicite datos antes de ejecutar controles de ActiveX. Para ello, establezca la seguridad del explorador en **Alta**.
  
    Para aumentar el nivel de seguridad en Microsoft Internet Explorer, siga estos pasos:
  
    1.  En el menú **Herramientas** de Internet Explorer, haga clic en **Opciones de Internet**.  
    2.  En el cuadro de diálogo **Opciones de Internet**, haga clic en la ficha **Seguridad** y, a continuación, en el icono **Internet**.  
    3.  En **Nivel de seguridad de la zona**, mueva el control deslizante hacia la configuración de seguridad **Alta**. De este modo, se establece el nivel de seguridad para todos los sitios Web que visite en Alta.
  
    **Nota** Si no hay visible un control deslizante, haga clic en **Nivel predeterminado** y, a continuación, mueva el control deslizante hacia **Alta**.
  
    **Nota** Al establecer el nivel en **Alta**, es posible que algunos sitios web no funcionen correctamente. Si tiene dificultades para utilizar un sitio web después de cambiar esta configuración y está seguro de que el sitio es seguro de utilizar, puede agregarlo a la lista de sitios de confianza. Esto permitirá que el sitio funcione correctamente, incluso con la configuración de seguridad en **Alto**.
  
    **Consecuencias de la solución provisional:** Preguntar antes de ejecutar los controles ActiveX conlleva efectos secundarios. Muchos sitios web de Internet o una intranet utilizan controles ActiveX para aportar funciones adicionales. Por ejemplo, un sitio de comercio electrónico en línea o el sitio de un banco pueden utilizar controles ActiveX para ofrecer menús, formularios de pedido o incluso movimientos de cuentas. Preguntar antes de ejecutar los controles ActiveX (Pedir datos) es una configuración global que afecta a todos los sitios de Internet e Intranet. Cuando habilite esta solución, se le preguntará para que dé su conformidad con bastante frecuencia. En cada pregunta, si confía en el sitio que está visitando, haga clic en **Sí** para ejecutar los controles ActiveX. Si no desea que se le pregunte para todos estos sitios, siga los pasos de la sección "Agregue sitios en los que confía a la zona de sitios de confianza de Internet Explorer".
  
    **Agregar sitios en los que confía a la zona de sitios de confianza de Internet Explorer**
  
    Después de configurar Internet Explorer para exigir que le pregunte antes de ejecutar controles y secuencias de comandos ActiveX en las zonas Internet e Intranet local, puede agregar sitios en los que confíe a la zona Sitios de confianza de Internet Explorer. De esta forma, podrá seguir utilizando como siempre los sitios web de confianza al tiempo que colabora para protegerse de este ataque en los sitios en los que no confía. Se recomienda agregar solamente sitios en los que confíe a la zona Sitios de confianza.
  
    Para ello, siga estos pasos:
  
    1.  En Internet Explorer, haga clic en **Herramientas**, **Opciones de Internet** y, a continuación, en la ficha **Seguridad**.  
    2.  En el cuadro **Seleccione una zona de contenido web para especificar la configuración de seguridad de la misma**, haga clic en **Sitios de confianza** y, a continuación, en **Sitios**.  
    3.  Si desea agregar sitios que no requieren un canal cifrado, haga clic para desactivar la casilla de verificación **Requerir comprobación del servidor (https:) para todos los sitios de esta zona**.  
    4.  En el cuadro **Agregar este sitio web a la zona**, escriba la dirección URL de un sitio en el que confíe y haga clic en **Agregar**.  
    5.  Repita estos pasos para cada sitio que desee agregar a la zona.  
    6.  Haga clic en **Aceptar** dos veces para confirmar los cambios y regresar a Internet Explorer.
  
    **Nota** Agregue todos los sitios de confianza para los que tenga la certeza de que no realizarán ninguna acción perjudicial en su equipo. En concreto, hay dos sitios que es aconsejable agregar: "\*.windowsupdate.microsoft.com" y "\*.update.microsoft.com" (sin las comillas). Se trata de los sitios que alojarán la actualización y requieren de un control ActiveX para instalarla.
  
#### Preguntas más frecuentes sobre la vulnerabilidad de agente de objetos WMI (CVE-2006-4704):
  
**¿Cuál es el alcance de esta vulnerabilidad?**  
Se trata de una vulnerabilidad de ejecución remota de código. Un atacante que aprovechara esta vulnerabilidad podría lograr el control completo de un sistema afectado. De esta forma, un intruso podría instalar programas; ver, cambiar o eliminar datos; o crear cuentas nuevas con todos los derechos de usuario.
  
**¿Cuál es la causa de esta vulnerabilidad?**  
La validación no adecuada de los controles ejecutados por el agente de objetos WMI provoca la vulnerabilidad.
  
**¿Qué es el agente de objetos WMI?**  
El agente de objetos WMI es un control ActiveX que el asistente de WMI usa en Visual Studio 2005. Cuando un usuario invoca la característica de asistente de WMI de Visual Studio 2005, el asiste usa internamente el agente de objetos WMI para ejecutar otros controles.
  
**¿Para qué puede utilizar un atacante esta vulnerabilidad?**  
Un intruso que aprovechara esta vulnerabilidad podría conseguir el mismo nivel de derechos de usuario que el usuario local. Por tanto, los usuarios cuyas cuentas estén configuradas con pocos derechos de usuario en el sistema correrían un riesgo menor que aquellos que cuenten con derechos de usuario administrativos.
  
**¿Quién podría aprovechar esta vulnerabilidad?**  
En el supuesto de un ataque a través de Web, el atacante tendría que alojar un sitio Web que contuviera una página Web destinada a intentar aprovechar esta vulnerabilidad. El atacante no podría obligar a los usuarios a visitar un sitio web especialmente diseñado. Por lo tanto, tendría que atraerlos al sitio Web; para ello debería, por ejemplo, incitarles a hacer clic en un vínculo que les llevara al sitio Web del atacante.
  
**¿Qué sistemas están más expuestos a esta vulnerabilidad?**  
Para que se produzca una acción de este tipo, esta vulnerabilidad requiere que el usuario haya iniciado una sesión y visite un sitio web. Por lo tanto, cualquier sistema que tenga instalado Visual Studio 2005 en el que se utilice Internet Explorer de forma habitual, como estaciones de trabajo y servidores de Terminal Server, está expuesto a esta vulnerabilidad.
  
**Estoy ejecutando Internet Explorer 7. ¿Soluciona esto la vulnerabilidad?**  
Sí. Los clientes que usan Internet Explorer 7 con la configuración predeterminada no están expuestos mientras no activen el control del agente de objetos WMI a través de la característica ActiveX opcional en la zona Internet. Sin embargo, si un cliente ha usado este control ActiveX en una versión anterior de Internet Explorer, entonces este control ActiveX está habilitado para funcionar en Internet Explorer 7, incluso si el cliente no lo ha aprobado explícitamente mediante la característica ActiveX opcional.
  
**¿Qué es la característica ActiveX opcional de Internet Explorer 7?**  
Internet Explorer 7 incluye la característica ActiveX opcional, lo que significa que casi todos los controles ActiveX preinstalados están desactivados de forma predeterminada. A los usuarios se les pregunta en la barra de información antes de que puedan tener acceso a un control ActiveX instalado anteriormente que todavía no se haya usado en Internet. De este modo, un usuario puede permitir o denegar el acceso según cada control. Para obtener más información sobre ésta y otras características, consulte la [página de características de Windows Internet Explorer 7](http://www.microsoft.com/windows/ie/ie7/about/features/default.mspx).
  
**Estoy ejecutando Internet Explorer en Windows Server 2003. ¿Soluciona esto la vulnerabilidad?**  
Sí. De forma predeterminada, Internet Explorer en Windows Server 2003 se ejecuta en un modo restringido conocido como [Configuración de seguridad mejorada](http://msdn.microsoft.com/library/default.asp?url=/workshop/security/szone/overview/esc_changes.asp). Este modo establece el nivel de seguridad para la zona Internet en Alto. Esto constituye un factor atenuante para sitios web que no se han agregado a la zona de sitios de confianza de Internet Explorer. Vea la sección P+F correspondiente a esta actualización de seguridad para obtener más información acerca de la configuración de seguridad mejorada de Internet Explorer.
  
**¿Qué es la Configuración de seguridad mejorada de Internet Explorer?**  
La Configuración de seguridad mejorada de Internet Explorer es un grupo de valores preconfigurados de Internet Explorer que reducen la posibilidad de que los usuarios o los administradores descarguen o ejecuten contenido web malintencionado en un servidor. La configuración de seguridad mejorada de Internet Explorer reduce esta amenaza al modificar numerosos valores de configuración relacionados con la seguridad, incluidos los de las fichas Seguridad y Opciones Avanzadas en Opciones de Internet. Algunas de las modificaciones principales son las siguientes:
  
-   El nivel de seguridad para la zona Internet está establecido en Alto. Esta configuración deshabilita las secuencias de comandos, los componentes de ActiveX, la máquina virtual de Microsoft (Microsoft VM), el contenido HTML y las descargas de archivos.  
-   Se ha deshabilitado la detección automática de sitios de intranet. Esta configuración asigna a la zona Internet todos los sitios web de intranet y todas las rutas de acceso que cumplen la Convención de nomenclatura universal (UNC, Universal Naming Convention) y que no aparecen enumeradas de forma específica en la zona Intranet local.  
-   Se han deshabilitado la instalación a petición y las extensiones de explorador que no pertenecen a Microsoft. Esta configuración impide que las páginas web instalen componentes de modo automático y que se ejecuten las extensiones que no sean de Microsoft.  
-   Se ha deshabilitado el contenido multimedia. Esta configuración impide que se ejecuten archivos de música, animación y clips de vídeo.
  
Si desea obtener más información sobre la Configuración de seguridad mejorada de Internet Explorer, consulte la guía de administración de la configuración de seguridad mejorada de Internet Explorer, que se puede encontrar en el siguiente [sitio web](http://www.microsoft.com/downloads/details.aspx?familyid=d41b036c-e2e1-4960-99bb-9757f7e9e31b&displaylang=en) (en inglés).
  
**¿Cómo funciona esta actualización?**  
La actualización elimina la vulnerabilidad al modificar la manera en que el agente de objetos WMI ejecuta otros controles.
  
**En el momento de emitir este boletín de seguridad, ¿se había divulgado ya esta vulnerabilidad?**  
  
Sí. Esa vulnerabilidad ya se ha divulgado. Se le ha asignado el número de vulnerabilidad y exposición común CVE-2006-4704.
  
**En el momento de publicar este boletín de seguridad, ¿había recibido Microsoft algún informe que indicase que se estaba utilizando esta vulnerabilidad?**  
Sí. Esta actualización de seguridad soluciona la vulnerabilidad. A la vulnerabilidad que se ha tratado se le ha asignado el número de vulnerabilidad y exposición común CVE-2006-4704.
  
Información sobre la actualización de seguridad  
-----------------------------------------------
  
**Software afectado:**
  
Para obtener información sobre la actualización de seguridad específica para su software afectado, haga clic en el vínculo apropiado:
  
#### Visual Studio 2005 (todas las versiones)
  
**Requisitos previos**  
Esta actualización de seguridad requiere Microsoft Visual Studio 2005.
  
Debe estar instalado Microsoft Windows Installer 3.1. Para instalar la versión más reciente de Windows Installer, visite el siguiente sitio Web de Microsoft:
  
[Windows Installer 3.1 redistribuible (v2)](http://www.microsoft.com/downloads/details.aspx?familyid=889482fc-5f56-4a38-b838-de776fd4138c)
  
**Inclusión en futuros Service Packs:**  
La actualización para este problema se incluirá en siguientes Service Packs.
  
**Información sobre la instalación**
  
Esta actualización de seguridad admite los parámetros de instalación que se indican a continuación.
  
<p> </p>
<table class="dataTable" style="border:1px solid black;">
<caption>
Parámetros de instalación de la actualización de seguridad admitidos  
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Parámetro  
</th>
<th style="border:1px solid black;" >
Descripción  
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Muestra las opciones de la línea de comandos.
</td>
</tr>
<tr>
<th colspan="2" style="border:1px solid black;">
Modos de instalación
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/q\[n|b|r|f\]**
</td>
<td style="border:1px solid black;">
Establece el nivel de interfaz de usuario.  
n: no se da interacción del usuario  
b: interacción del usuario básica  
r: interacción del usuario reducida  
f: interacción del usuario total (nivel predeterminado)
</td>
</tr>
<tr>
<th colspan="2" style="border:1px solid black;">
Opciones de instalación
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/extract \[directorio\]**
</td>
<td style="border:1px solid black;">
Extrae el paquete al directorio especificado.
</td>
</tr>
<tr>
<th colspan="2" style="border:1px solid black;">
Opciones de reinicio
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
No reinicia cuando termina la instalación.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia el equipo después de la instalación y obliga a otras aplicaciones a cerrarse cuando se apaga el equipo sin guardar antes los archivos abiertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Muestra un cuadro de diálogo que pide al usuario local que permita un reinicio.
</td>
</tr>
<tr>
<th colspan="2" style="border:1px solid black;">
Opciones de registro
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/l\[i|w|e|a|r|u|c|m|o|p|v|x|+|!|\*\] &lt;Archivo\_registro&gt;**
</td>
<td style="border:1px solid black;">
i: mensajes de estado  
w: avisos no graves  
e: todos los mensajes de error  
a: inicio de acciones  
r: registros específicos para la acción  
u: solicitudes del usuario  
c: parámetros iniciales de IU  
m: información de falta de memoria o salida grave  
o: mensajes de espacio insuficiente en disco  
p: propiedades de Terminal Server  
v: información detallada  
x: información de depuración extra  
+: anexar al archivo de registro existente  
! : vaciar cada línea al registro  
\*: registrar toda la información, excepto las opciones v y x
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/log &lt;Archivo\_registro&gt;**
</td>
<td style="border:1px solid black;">
Equivalente a /l\* &lt;Archivo\_registro&gt;
</td>
</tr>
</table>
 
**Nota** Estos parámetros pueden combinarse en el mismo comando. Para obtener más información sobre los parámetros de instalación admitidos, vea las opciones de la línea de comandos de Windows Installer. Para obtener más información acerca de Windows Installer, visite el sitio web de MSDN de Windows Installer.

**Información sobre la implementación**

Para instalar la actualización de seguridad sin intervención del usuario, escriba la línea de comandos siguiente en el símbolo del sistema:

**VS80-KB925674-x86.exe /qn**

**Nota** El parámetro **/qn** suprime todos los mensajes. Esto incluye los mensajes de error. Los administradores deben usar uno de los métodos admitidos para verificar que la instalación ha sido correcta al utilizar el parámetro **/qn**.

Para instalar la actualización de seguridad sin necesidad de reiniciar el sistema, escriba la línea de comandos aplicable en el símbolo del sistema:

**VS80-KB925674-x86.exe /norestart**

Para obtener más información acerca de cómo implementar esta actualización de seguridad mediante el uso de Software Update Services, visite el [sitio web de Software Update Services](http://go.microsoft.com/fwlink/?linkid=21125). Para obtener más información acerca de cómo implementar esta actualización de seguridad con Windows Server Update Services, visite el [sitio web de Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Esta actualización de seguridad estará también disponible en el [sitio web Windows Update](http://update.microsoft.com/microsoftupdate).

**Requisito de reinicio**  
En algunos casos, esta actualización no requiere reiniciar el sistema. Sin embargo, si algún archivo necesario está en uso, habrá que reiniciar el sistema. Si se presenta este comportamiento, aparecerá un mensaje que aconseja reiniciar el sistema.

Para reducir las posibilidades de que sea preciso un reinicio, cierre todas las instancias de Visual Studio 2005 antes de instalar la actualización de seguridad. Para obtener más información acerca de los motivos por los que se le puede pedir que reinicie el sistema, consulte el [artículo 887012 de Microsoft Knowledge Base](http://support.microsoft.com/kb/887012).

**Información sobre la eliminación**  
Para quitar esta actualización, utilice la herramienta Agregar o quitar programas, que se encuentra en el Panel de control.

**Información sobre archivos**  
La versión en inglés de esta actualización presenta los atributos de archivo (o posteriores) que se indican en la tabla siguiente. Las fechas y horas de estos archivos se muestran en el horario universal coordinado (UTC). Cuando se consulta la información de archivo, ésta se convierte al horario local. Para averiguar la diferencia entre el horario universal coordinado y el local, utilice la ficha **Zona horaria** en la herramienta Fecha y hora del Panel de control.

Microsoft Visual Studio 2005

| Nombre de archivo  | Versión       | Fecha       | Hora  | Tamaño |
|--------------------|---------------|-------------|-------|--------|
| wmiscriptutils.dll | 8.0.50727.236 | 28-Oct-2006 | 08:46 | 54,272 |

**Comprobación de la instalación de la actualización**

**Información sobre versiones de archivo**

**Nota** Puesto que existen varias versiones de Microsoft Windows, los pasos que se indican a continuación pueden ser diferentes en su equipo. En tal caso, consulte la documentación del producto para ejecutar los pasos necesarios.

1.  Haga clic en **Inicio** y, después, en **Buscar**.
2.  En el panel **Resultados de la búsqueda**, haga clic en **Todos los archivos y carpetas** del **Asistente para búsqueda**.
3.  En el cuadro **Todo o parte del nombre de archivo**, escriba un nombre de archivo de la tabla de información de archivos correspondiente y, a continuación, haga clic en **Buscar**.
4.  En la lista de archivos, haga clic con el botón secundario del mouse en un nombre de archivo de la tabla de información de archivos correspondiente y, después, haga clic en **Propiedades**.
5.  En la ficha **Versión**, determine la versión del archivo instalado en el equipo por comparación con la versión documentada en la tabla de información de archivos correspondiente.  
    **Nota** Los atributos distintos a la versión del archivo pueden cambiar durante la instalación. La comparación de otros atributos de los archivos con los datos de la tabla de información de archivos no constituye un método apropiado para comprobar la instalación de la actualización. Además, en ciertos casos, el nombre de los archivos se puede cambiar durante la instalación. Si no aparece información de la versión o del archivo, recurra a otro de los métodos disponibles para comprobar la instalación de la actualización.

### Información adicional:

**Agradecimientos**

Microsoft [muestra su agradecimiento](http://go.microsoft.com/fwlink/?linkid=21127) a todas las personas que han trabajado con nosotros para proteger a los clientes:

-   [TippingPoint](http://www.tippingpoint.com/) y [Zero Day Initiative](http://www.zerodayinitiative.com/), por informar de la vulnerabilidad de agente de objetos WMI ([CVE-2006-4704](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2006-4704)).

**Obtención de otras actualizaciones de seguridad:**

Las actualizaciones para otros problemas de seguridad están disponibles en las ubicaciones siguientes:

-   Hay actualizaciones de seguridad disponibles en el [Centro de descarga de Microsoft](http://www.microsoft.com/downloads/search.aspx?displaylang=es). Si realiza una búsqueda de las palabras clave “revisión de seguridad” podrá encontrarlas fácilmente.
-   Hay disponibles actualizaciones para las plataformas de usuarios en el [sitio web Windows Update](http://go.microsoft.com/fwlink/?linkid=40747) de Microsoft.

**Soporte técnico:**

-   Puede solicitar soporte técnico en los [Servicios de soporte técnico de Microsoft](http://support.microsoft.com/default.aspx?scid=fh;es-es;incidentsubmit) o a través del teléfono 902 197 198.
-   Los clientes internacionales pueden recibir soporte técnico en las subsidiarias de Microsoft de sus países. Las llamadas de soporte técnico relacionadas con las actualizaciones de seguridad son gratuitas. Para obtener más información acerca de cómo ponerse en contacto con Microsoft en relación con problemas de soporte técnico, visite el [sitio web de soporte técnico internacional de Microsoft](http://go.microsoft.com/fwlink/?linkid=21155).

**Recursos de seguridad:**

-   El sitio web [Microsoft TechNet Security](http://www.microsoft.com/spain/technet/seguridad/default.mspx) proporciona información adicional acerca de la seguridad de los productos de Microsoft.
-   [Centro de administración de actualizaciones de TechNet](http://go.microsoft.com/fwlink/?linkid=69903)
-   [Microsoft Software Update Services](http://go.microsoft.com/fwlink/?linkid=21133)
-   [Microsoft Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120)
-   [Microsoft Baseline Security Analyzer](http://www.microsoft.com/spain/technet/seguridad/herramientas/mbsa.mspx) (MBSA)
-   [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130)
-   [Microsoft Update](http://update.microsoft.com/microsoftupdate)
-   Catálogo de actualizaciones de Windows: Para obtener más información sobre el Catálogo de actualizaciones de Windows, consulte el [artículo 323166 de Microsoft Knowledge Base](http://support.microsoft.com/kb/323166).
-   [Office Update](http://go.microsoft.com/fwlink/?linkid=21135)

**Software Update Services:**

Software Update Services (SUS) permite a los administradores implementar con rapidez y confiabilidad las actualizaciones críticas y de seguridad más recientes en servidores basados en Windows 2000 y Windows Server 2003, y en sistemas de escritorio donde se ejecute Windows 2000 Professional o Windows XP Professional.

Para obtener más información acerca de cómo implementar actualizaciones de seguridad con Software Update Services, visite el [sitio web de Software Update Services](http://go.microsoft.com/fwlink/?linkid=21133).

**Windows Server Update Services:**

Windows Server Update Services (WSUS) permite a los administradores implementar con rapidez y fiabilidad las actualizaciones críticas y de seguridad más recientes en sistemas operativos Windows 2000 y versiones posteriores, Office XP y versiones posteriores, Exchange Server 2003 y SQL Server 2000 hasta Windows 2000 y sistemas operativos posteriores.

Para obtener más información acerca de cómo implementar actualizaciones de seguridad con Windows Server Update Services, visite el [sitio web de Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120).

**Systems Management Server:**

Microsoft Systems Management Server (SMS) ofrece una solución empresarial altamente configurable para la administración de las actualizaciones. Mediante SMS, los administradores pueden identificar los sistemas basados en Windows que necesitan actualizaciones de seguridad, así como realizar la implementación controlada de las actualizaciones en la empresa con una repercusión mínima para los usuarios finales. Para obtener más información acerca de cómo pueden utilizar SMS 2003 los administradores para implementar actualizaciones de seguridad, visite el [sitio web de administración de revisiones de seguridad de SMS 2003](http://go.microsoft.com/fwlink/?linkid=22939). Los usuarios de SMS 2.0 también pueden usar [Software Updates Service Feature Pack](http://go.microsoft.com/fwlink/?linkid=33340) como ayuda para la implementación de actualizaciones de seguridad. Para obtener más información acerca de SMS, visite el [sitio web de SMS](http://go.microsoft.com/fwlink/?linkid=21158).

**Nota** SMS usa las herramientas Microsoft Baseline Security Analyzer, Microsoft Office Detection Tool y Enterprise Update Scan Tool para proporcionar un amplio soporte técnico en la detección e implementación de las actualizaciones indicadas en los boletines de seguridad. Puede que estas herramientas no detecten algunas actualizaciones de software. Los administradores pueden usar las prestaciones de inventario de SMS en estos casos para concretar qué actualizaciones se deben aplicar en cada sistema. Para obtener más información acerca de este procedimiento, visite el siguiente [sitio web](http://go.microsoft.com/fwlink/?linkid=33341), en inglés. Algunas actualizaciones de seguridad pueden requerir derechos administrativos y que se reinicie el sistema. Los administradores pueden usar la utilidad Elevated Rights Deployment Tool (disponible en [SMS 2003 Administration Feature Pack](http://go.microsoft.com/fwlink/?linkid=33387) y en [SMS 2.0 Administration Feature Pack](http://go.microsoft.com/fwlink/?linkid=21161)) para instalar estas actualizaciones.

**Renuncia:**

La información proporcionada en Microsoft Knowledge Base se suministra "tal cual", sin garantía de ningún tipo. Microsoft renuncia al otorgamiento de toda garantía, tanto expresa como implícita, incluidas las garantías de comerciabilidad e idoneidad para un determinado fin. Ni Microsoft Corporation ni sus proveedores se responsabilizarán en ningún caso de daños directos, indirectos, incidentales, consecuenciales, pérdida de beneficios o daños especiales, aun en el supuesto de que se hubiera informado a Microsoft Corporation o a sus proveedores de la posibilidad de dichos daños. Algunos estados de Estados Unidos no permiten la exclusión o limitación de responsabilidad por daños consecuenciales o incidentales, y, por tanto, la limitación anterior puede no ser aplicable en su caso.

**Revisiones:**

-   V1.0 (12 de diciembre de 2006): Publicación del boletín.

*Built at 2014-04-18T01:50:00Z-07:00*
